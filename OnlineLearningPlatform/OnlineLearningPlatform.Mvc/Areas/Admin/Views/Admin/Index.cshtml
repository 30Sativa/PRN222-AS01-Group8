@model OnlineLearningPlatform.Services.DTO.Response.Admin.DashboardStatisticsDto
@{
    ViewData["Title"] = "Bảng điều khiển";
    var maxRevenue = Model.RevenueByMonth.Any() ? Model.RevenueByMonth.Max(x => x.Value) : 1m;
    if (maxRevenue <= 0) { maxRevenue = 1; }
}

<!-- Stats Cards -->
<div class="stats-row">
    <div class="stat-card card-blue">
        <div class="stat-content">
            <h2>@Model.TotalUsers</h2>
            <p>Tổng người dùng</p>
        </div>
    </div>

    <div class="stat-card card-teal">
        <div class="stat-content">
            <h2>@Model.TotalCourses</h2>
            <p>Tổng khóa học</p>
        </div>
    </div>

    <div class="stat-card card-purple">
        <div class="stat-content">
            <h2>@Model.TotalEnrollments</h2>
            <p>Tổng đăng ký khóa học</p>
        </div>
    </div>
</div>

<!-- Content Grid -->
<div class="content-grid">
    <div class="chart-section">
        <h3>Tổng quan doanh thu (theo tháng)</h3>
        <div class="chart-placeholder">
            @if (Model.RevenueByMonth.Any())
            {
                <div class="bar-chart">
                    @foreach (var item in Model.RevenueByMonth)
                    {
                        var pct = maxRevenue > 0 ? (double)(item.Value / maxRevenue) * 100 : 0;
                        <div class="bar" style="height: @(pct)%" title="@item.Label: @(item.Value.ToString("N0")) VNĐ"></div>
                    }
                </div>
                <div class="chart-labels">
                    @foreach (var item in Model.RevenueByMonth)
                    {
                        <span>@item.Label</span>
                    }
                </div>
            }
            else
            {
                <p class="chart-empty">Chưa có dữ liệu doanh thu.</p>
            }
        </div>
    </div>

    <div class="seller-card">
        <h3>Giảng viên hàng đầu</h3>
        @if (!string.IsNullOrEmpty(Model.TopTeacherName))
        {
            <p class="seller-info"><strong>@Model.TopTeacherName</strong></p>
            <p class="seller-role">@Model.TopTeacherCourseCount khóa học</p>
        }
        else
        {
            <p class="chart-empty">Chưa có dữ liệu giảng viên.</p>
        }
    </div>
</div>
